<hmtl>
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>

<!-- Add fancyBox -->
<link rel="stylesheet" href="fancybox/source/jquery.fancybox.css?v=2.1.6" type="text/css" media="screen" />
<script type="text/javascript" src="fancybox/source/jquery.fancybox.pack.js?v=2.1.6"></script>

<style>
    table th, table td {
        width: 200px;
        height:70px;
        padding: 5px;
    }
    table span {
        display:block;
        background-color: #ccc;
        border: 1px solid black;
        color: fff;
        height: 30px;
        width: 100%;
    }
</style>
<script>

    //delcare sweeet sweet global veraible for the playerdata so that I can manipulate it whenever i want
    // note: this is super sweet and in no way a bad programming practice
    var playerdata;

    $(document).ready(function () {
        $(".various").fancybox({
            maxWidth    : 800,
            maxHeight   : 600,
            fitToView   : false,
            width       : '70%',
            height      : '70%',
            autoSize    : false,
            closeClick  : false,
            openEffect  : 'none',
            closeEffect : 'none'
        });
        $('.event').on("dragstart", function (event) {
            var dt = event.originalEvent.dataTransfer;
            dt.setData('Text', $(this).attr('id'));
        });
        $('table td').on("dragenter dragover drop", function (event) {
            event.preventDefault();
            if (event.type === 'drop') {
                var data = event.originalEvent.dataTransfer.getData('Text', $(this).attr('id'));
                de = $('#' + data).detach();
                if (event.originalEvent.target.tagName === "SPAN") {
                    de.insertBefore($(event.originalEvent.target));
                }
                else {
                    de.appendTo($(this));
                }
                // click on link to show fancybox for the player
                $('a[href*="#popup'+data+'"]').click();

                // update playerdata
                var j;
                for (j=0;j<playerdata.length;j++){
                    if (playerdata[j].id === data){
                        playerdata[j].column= $(this).attr('id');
                    }
                }
                // save updated data to local storage
                localStorage.setItem('playerData', JSON.stringify(playerdata));
            };
        });
    })
</script>
</head>
<body>
    <table id="#draftTable" border="1">
        <tr>
            <th>Picks</th>
            <th>Team 1</th>
            <th>Team 2</th>
            <th>Team 3</th>
            <th>Team 4</th>
        </tr>
        <tr>
            <td id="col1"></td>
            <td id="col2"></td>
            <td id="col3"></td>
            <td id="col4"></td>
            <td id="col5"></td>
        </tr>
    </table>
    <span id="invisiboxes">
    </span>

    <div id="invisilinks" style="display: none;">
    </div>


    <script>
    $.getJSON( "data/data.json", function( json ) {

        playerdata = JSON.parse(localStorage.getItem('playerData'));

        if (typeof playerdata == 'undefined'){
            playerdata = json.Players;
        }

        var i;
        for (i=0; i<playerdata.length; i++){
            $('#invisilinks').append('<a class="various" href="#popup'+playerdata[i].id+'">click me</a>');
            $('#invisiboxes').append('<div id="popup'+playerdata[i].id+'" style="width: 500px; display: none;">'+
                                     '   <h2>'+
                                     '       Lorem ipsum dolor sit amet'+
                                     '  </h2>'+
                                     '   Donkey Dick '+playerdata[i].name+'!!!'+
                                     '</div>');
            $('#'+playerdata[i].column).append('<div class="event" id="'+playerdata[i].id+'" draggable="true">'+playerdata[i].name+'</div>');
        }
    });
    </script>
</body>